<p align="center" >
  <img src="https://static.vecteezy.com/system/resources/previews/004/568/693/original/database-lock-line-icon-vector.jpg" width="300" height="300" />
</p>

# DB Lock 이란?
데이터베이스에서 DB LOCK은 동시에 **여러 트랜잭션이 데이터베이스의 일부를 접근하거나 수정하는 것을 제어하기 위해 사용되는 메커니즘**이다. DB LOCK은 트랜잭션 간의 충돌을 방지하고 **데이터의 일관성과 무결성**을 보장하기 위해 사용된다. 

## 공유 잠금 (Share Lock)
* 읽기 작업을 수행하는 트랜잭션 간에 설정된다.
* 여러 트랜잭션은 동일한 데이터를 동시에 읽을 수 있지만, 읽기 도중에 다른 트랜잭션에 의한 수정이 일어나는 것을 방지하기 위해 공유 잠금을 설정한다.
* 공유 잠금은 동시 읽기를 허용하므로 다른 트랜잭션들도 공유 잠금을 설정할 수 있다.
* 공유 잠금을 설정하여 다른 읽기 트랜잭션들이 동시에 동일한 데이터를 읽을 수 있어 데이터 일관성을 유지한다.

## 배타적 잠금 (Exclusive Lock)
* 쓰기 작업을 수행하는 트랜잭션이 데이터를 수정하는 동안 설정된다.
* 배타적 잠금이 설정된 트랜잭션이 실행 중인 동안 다른 트랜잭션은 해당 데이터를 읽거나 수정할 수 없다.
* 데이터의 일관성을 유지하고 동시 수정으로 인한 충돌을 방지한다.
- 예) 주문 테이블의 특정 주문을 수정하는 작업을 수행하는 트랜잭션이 있을 때, 해당 트랜잭션이 배타적 잠금을 설정하여 다른 트랜잭션이 동시에 해당 주문을 수정하거나 읽지 못하도록 한다.

## 갱신 잠금 (Update Lock)
* 공유 잠금과 배타적 잠금의 중간 형태
* 트랜잭션이 데이터를 읽을 때는 공유 잠금을 설정하고, 데이터를 수정할 때는 배타적 잠금을 설정한다.
* 갱신 잠금을 설정한 트랜잭션은 다른 트랜잭션들이 공유 잠금을 설정할 수 있지만, 배타적 잠금을 설정하는 것은 제한된다.

## 의도 잠금 (Intent Lock)
* 트랜잭션이 데이터의 하위 개체에 LOCK을 설정할 때 사용됩니다.
* 의도 잠금은 상위 수준의 잠금 요청을 나타내며, 다른 트랜잭션이 해당 데이터의 잠금 요청을 받을 때 충돌을 방지하기 위해 사용된다. 
* 트랜잭션이 특정 테이블의 행을 수정하기 위해 배타적 잠금을 설정하면 해당 테이블에 대한 의도 잠금이 설정된다 .
- 예) 주문 테이블과 주문 상세 테이블이 있을 때, 주문 테이블을 수정하려는 트랜잭션이 의도 잠금을 설정한다. 이 의도 잠금은 다른 트랜잭션이 주문 상세 테이블에 배타적 잠금을 설정하지 못하도록 방지한다.

## 예상 질문

### 1. 데이터베이스 잠금이란 무엇인가요?
데이터베이스 잠금은 동시 접근을 제어하고 데이터 일관성과 무결성을 보장하기 위해 사용한다. 동시 트랜잭션에서의 충돌을 방지하고 데이터의 정확성을 유지한다.

### 2. 데이터베이스 잠금의 종류는 무엇인가요?
데이터베이스 잠금에는 공유 잠금, 배타적 잠금, 의도 잠금, 업데이트 잠금 등이 있다.

### 3. 공유 잠금의 목적은 무엇인가요?
공유 잠금은 여러 트랜잭션이 동시에 특정 데이터 항목을 읽을 수 있도록 한다. 동시 읽기 작업을 허용하면서 다른 트랜잭션이 데이터를 수정하지 못하도록 한다.

### 4. 배타적 잠금은 언제 사용되나요?
배타적 잠금은 트랜잭션이 데이터 항목을 수정해야 할 때 사용된다. 해당 잠금이 설정된 트랜잭션이 실행 중일 때 다른 트랜잭션은 해당 데이터를 읽거나 수정할 수 없다.

### 5. 의도 잠금의 개념을 설명해주세요.
의도 잠금은 특정 리소스에 대한 잠금을 설정하려는 트랜잭션의 의도를 나타내는 더 높은 수준의 잠금이다. 다른 잠금들 간의 충돌을 방지하기 위해 사용된다.

### 6. 데이터베이스 잠금이 데이터 무결성에 어떻게 기여하나요?
데이터베이스 잠금은 여러 트랜잭션이 동시에 동일한 데이터 항목에 접근하거나 수정하는 것을 방지하여 데이터 무결성을 유지한다. 충돌을 방지하고 일관성을 유지한다.

### 7. 데드락(Deadlock)이란 무엇이며 어떻게 방지할 수 있나요?
데드락은 두 개 이상의 트랜잭션이 서로가 소유한 잠금을 무한히 대기하는 상황이다. 데드락을 방지하기 위해 타임아웃, 최대 리소스 수 설정, 데드락 감지 알고리즘 등의 방법을 사용한다.

### 8. 잠금 상승(Lock Escalation)의 개념을 설명해주세요.
잠금 상승은 데이터베이스 시스템이 세밀한 잠금을 보다 적은 수의 더 큰 잠금으로 자동 변환하는 메커니즘이다. 많은 수의 잠금을 관리하는 부담을 줄이고 성능을 향상시킨다.

### 9. 데이터베이스는 잠금 충돌을 어떻게 처리하나요?
데이터베이스는 잠금 대기열, 타임아웃, 우선순위 규칙 등의 잠금 관리 기법을 사용하여 잠금 충돌을 처리한다. 트랜잭션이 충돌하는 잠금을 요청할 때, 해당 트랜잭션은 블록되거나 롤백되거나 대기하도록 처리된다.
### 10. 데이터베이스 잠금 사용의 장단점은 무엇인가요?
* 장점: 데이터베이스 잠금은 데이터 무결성을 유지하고 충돌을 방지하여 일관성을 유지한다. 동시 접근 제어를 통해 트랜잭션 간의 적절한 동기화를 가능하게 한다.
* 단점: 잠금의 과도한 사용이나 부적절한 사용은 동시성과 성능을 저하시킬 수 있다. 데드락이나 잠금 경합 등의 문제가 발생할 수 있으며, 이로 인해 트랜잭션 처리에 지연이 발생할 수 있다.
